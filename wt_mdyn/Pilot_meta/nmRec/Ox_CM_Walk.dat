MOLINFO STRUCTURE=reference.pdb 

# Compute the distance with the CM of the protein and the six coordinant oxygens

# Select all the protein atoms
cm_prot: COM ATOMS=1-3261
cm_O: COM ATOMS=1175,1196,1222,1245,1330,1331
cm_Ca: COM ATOMS=3262
d1: DISTANCE ATOMS=cm_prot,cm_Ca
d2: DISTANCE ATOMS=cm_O,cm_Ca

# dump a file containing charges and masses (useful for post-processing)
DUMPATOMS ATOMS=cm_prot,cm_Ca,cm_O FILE=coms.xyz STRIDE=500 
DUMPMASSCHARGE FILE=mcfile


# Define the multiple walkers
metad: METAD ... 
   ARG=d2
   PACE=1000  

   # Pilot run: we want to sample the landscape, not its details
   SIGMA=0.01 

   # These parameters change in the four simulations
   HEIGHT=0.6 
   BIASFACTOR=10

   # Use a "large" grid
   GRID_MIN=0 
   GRID_MAX=6.0

   # Recover the c(t) for reweighting
   CALC_RCT
...


uwall: UPPER_WALLS ...
   ARG=d1 
   AT=5.5 
   KAPPA=30000 
   EXP=2 
   OFFSET=0
... 

PRINT ARG=d1,d2,metad.bias,metad.rbias,metad.rct,uwall.bias FILE=COLVAR STRIDE=500
